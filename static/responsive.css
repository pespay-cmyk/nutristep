/* CORRECTIONS RESPONSIVE MOBILE - NutriStep */
/* À ajouter dans base.html dans le <style> ou créer un fichier responsive.css */

/* ============================================
   1. DASHBOARD - Activités du mois en pleine largeur
   ============================================ */
@media (max-width: 768px) {
    /* Forcer activités du mois en pleine largeur sous repas */
    .dashboard-meals-activities-grid {
        grid-template-columns: 1fr !important;
    }
}

/* ============================================
   2. WEIGHT - Améliorer "Depuis 0"
   ============================================ */
@media (max-width: 768px) {
    /* Mettre les contrôles du graphique en vertical */
    .weight-chart-controls {
        flex-direction: column !important;
        align-items: stretch !important;
        gap: 12px !important;
    }

    .weight-chart-controls select {
        width: 100% !important;
    }

    .weight-chart-controls label {
        justify-content: center !important;
    }

    /* Responsive form saisie poids */
    .weight-form-grid {
        grid-template-columns: 1fr !important;
    }

    .weight-form-grid button {
        width: 100%;
    }
}

/* ============================================
   3. MEALS - Calendrier responsive
   ============================================ */
@media (max-width: 768px) {
    /* HAMBURGER MENU */
    .hamburger-btn {
        display: block;
        position: fixed;
        top: 16px;
        left: 16px;
        z-index: 1001;
        background: var(--primary-start);
        border: none;
        border-radius: 8px;
        padding: 12px;
        cursor: pointer;
        width: 48px;
        height: 48px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .hamburger-btn span {
        display: block;
        width: 24px;
        height: 3px;
        background: white;
        margin: 4px 0;
        transition: 0.3s;
        border-radius: 2px;
    }
    
    /* Animation croix */
    .hamburger-btn.active span:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
    }
    
    .hamburger-btn.active span:nth-child(2) {
        opacity: 0;
    }
    
    .hamburger-btn.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -7px);
    }
    
    /* Overlay sombre */
    .menu-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        backdrop-filter: blur(2px);
    }
    
    .menu-overlay.active {
        display: block;
    }
    
    /* Navbar cachée par défaut sur mobile */
    .navbar {
        position: fixed;
        top: 0;
        left: -280px;
        width: 280px;
        height: 100vh;
        z-index: 1000;
        transition: left 0.3s ease;
        overflow-y: auto;
        box-shadow: 2px 0 12px rgba(0,0,0,0.2);
    }
    
    .navbar.open {
        left: 0;
    }
    
    /* Logo en haut */
    .navbar .brand {
        padding: 20px 24px 16px 24px;
    }
    
    /* Nav collé juste sous le logo */
    .navbar nav {
        flex-direction: column;
        padding: 0;
        margin: 0;
    }
    
    .navbar nav a {
        width: 100%;
        padding: 16px 24px;
        border-radius: 0;
    }
    
    /* H1 décalé à droite pour éviter le burger */
    h1 {
        padding-left: 70px !important;
        margin-top: 0 !important;
    }
    
    /* Content sans padding-top excessif */
    .content {
        padding: 20px 10px !important;
    }
    
    /* Calendrier : forcer scroll horizontal fluide */
    .calendar-wrapper {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch;
    }

    .calendar-grid {
        min-width: 600px; /* Force largeur minimum pour 7 jours */
    }

    /* Réduire padding des jours */
    .calendar-day {
        padding: 8px 4px !important;
        font-size: 13px !important;
    }

    /* Indicateurs repas plus petits */
    .meal-indicator {
        font-size: 11px !important;
        padding: 2px 4px !important;
    }

    /* Modal ajout repas en plein écran */
    .modal-content {
        width: 95vw !important;
        max-width: none !important;
        margin: 10px auto !important;
        max-height: 90vh;
        overflow-y: auto;
    }

    /* Form dans modal : inputs en pleine largeur */
    .modal-form-grid {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
    }

    /* Historique repas sur 2 colonnes au lieu de 3 */
    .food-history-grid {
        grid-template-columns: repeat(2, 1fr) !important;
    }
}

/* ============================================
   4. RECAP - Tableau activités scrollable
   ============================================ */
@media (max-width: 768px) {
    /* Wrapper pour scroll horizontal */
    .recap-table-wrapper {
        overflow-x: auto !important;
        -webkit-overflow-scrolling: touch;
        margin: 0 -20px; /* Compenser le padding de .card */
        padding: 0 20px;
    }

    .recap-table {
        min-width: 800px; /* Force largeur minimum */
        margin: 0 auto; /* Centrer le tableau */
    }

    /* Pastilles exceptions/compensations : centrées et même taille */
    .summary-stats {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 12px !important;
        justify-content: center !important;
        max-width: 100% !important;
    }

    .summary-card {
        width: 100% !important;
        padding: 16px !important;
    }

    /* Stats en 2 colonnes au lieu de 4 */
    .recap-stats-grid {
        grid-template-columns: repeat(2, 1fr) !important;
    }

    /* Boutons filtres en pleine largeur */
    .recap-filter-buttons {
        flex-direction: column !important;
    }

    .recap-filter-buttons button {
        width: 100% !important;
    }
}

/* ============================================
   5. GLOBAL - Corrections générales mobile
   ============================================ */
@media (max-width: 768px) {
    /* Réduire padding général du contenu */
    .content {
        padding: 20px 10px !important;
        max-width: 100% !important;
    }

    /* Titres h1 plus petits */
    h1 {
        font-size: 24px !important;
        margin-bottom: 20px !important;
    }

    /* Cartes : réduire padding */
    .card {
        padding: 16px 12px !important;
        margin-bottom: 16px !important;
        margin-left: 0 !important;
        margin-right: 0 !important;
    }

    /* PROFILE - Stats IMC + pastilles */
    .profile-main-stats {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
    }

    /* IMC ne prend plus 2 colonnes sur mobile */
    .imc-card {
        grid-column: span 1 !important;
    }

    /* Jauge IMC responsive */
    .imc-gauge {
        max-width: 100% !important;
    }

    /* Stats grid : 1 colonne sur mobile */
    .stats-grid {
        grid-template-columns: 1fr !important;
        gap: 12px !important;
    }

    /* Tableaux : réduire taille police */
    table {
        font-size: 13px !important;
    }

    table th, table td {
        padding: 8px 6px !important;
    }

    /* Boutons : pleine largeur si nécessaire */
    .btn-primary, .btn {
        padding: 12px 20px !important;
    }

    /* Graph canvas : hauteur réduite */
    canvas {
        max-height: 250px !important;
    }
    /* Dashboard : utiliser toute la largeur */
    .dashboard-meals-activities-grid {
        margin: 0 !important;
        gap: 16px !important;
    }
}

/* ============================================
   6. DESKTOP - Profile stats en 3 colonnes
   ============================================ */
@media (min-width: 769px) {
    /* Masquer hamburger et overlay sur desktop */
    .hamburger-btn,
    .menu-overlay {
        display: none !important;
    }
    
    /* Navbar normale sur desktop */
    .navbar {
        position: relative;
        left: 0;
        width: auto;
        height: auto;
    }
    
    /* Tendances : 3 colonnes sur desktop */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 16px;
    }

    /* Stats profil principales */
    .profile-main-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
    }
}

/* ============================================
   6. TRÈS PETITS ÉCRANS (< 400px)
   ============================================ */
@media (max-width: 400px) {
    /* Stats en 1 colonne */
    .stats-grid {
        grid-template-columns: 1fr !important;
    }

    /* Navbar : icônes seulement, masquer texte */
    .navbar nav a span {
        display: none;
    }

    .navbar nav a {
        padding: 8px 12px !important;
    }
}
